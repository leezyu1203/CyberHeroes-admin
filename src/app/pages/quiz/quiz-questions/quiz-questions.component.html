<div class="flex flex-column gap-3" *ngIf="!isLoading; else loading">
  @if (quizLevel) {
  <h1 class="page-h1">
    Level {{ quizLevel.level + 1 }} - {{ quizLevel.level_name }}
  </h1>
  <div class="surface-100 border-round flex flex-column gap-2 p-4">
    <div class="flex flex-row gap-2 align-items-center vertical-align-middle">
        <span>Number of questions: </span>
        @if (!isQuesNumEditing) {
        <span>{{ quizLevel.question_num }}</span>
        <p-button icon="pi pi-file-edit" [rounded]="true" [outlined]="true" size="small" (onClick)="toggleQuesNumEdit()"></p-button>
        } @else {
            <p-inputnumber inputId="integeronly" [(ngModel)]="questionNumField" [disabled]="isUpdateQuesNumLoading"></p-inputnumber>
            <p-button label="Cancel" size="small" severity="secondary" (onClick)="toggleQuesNumEdit()" [disabled]="isUpdateQuesNumLoading"></p-button>
            <p-button label="Update" size="small" (onClick)="onUpdateQuesNum()" [disabled]="questionNumField == quizLevel.question_num || !questionNumField || questionNumField <= 0" [loading]="isUpdateQuesNumLoading"></p-button>
        }
    </div>
    <p-accordion value="0" (onOpen)="onAccordionOpen($event)">
      @for (ques of questions; track ques.id; let i = $index) {
      <p-accordion-panel [value]="i">
        <p-accordion-header>{{ ques.question }}</p-accordion-header>
        <p-accordion-content>
          <div class="flex flex-column gap-3">
            <div class="font-light text-sm text-green-600">
              Explanation: {{ ques.explanation }}
            </div>
            <div class="surface-100 border-round p-2 flex flex-column gap-2" *ngIf="ques.answers; else answerLoading">
              <div class="text-medium text-green-700 font-semibold">
                Answers:
              </div>
              <p-table [value]="ques.answers">
                <ng-template #body let-ans>
                  <tr>
                    <td>
                      <span>{{ ans.answer }}</span>
                      <span class="pl-2" *ngIf="ans.is_true">
                        <p-badge value="True" severity="success" badgeSize="small"></p-badge>
                      </span>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
            <ng-template #answerLoading>
              <p-skeleton width="100%" height="4rem" />
            </ng-template>
          </div>
        </p-accordion-content>
      </p-accordion-panel>
      }
    </p-accordion>
  </div>
  }
</div>
<ng-template #loading>
  <div class="flex flex-column gap-3">
    <p-skeleton width="15rem" height="3rem" borderRadius="16px" />
    <p-skeleton width="100%" height="4rem" />
  </div>
</ng-template>

<p-toast></p-toast>
