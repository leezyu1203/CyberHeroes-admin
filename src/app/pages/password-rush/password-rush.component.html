<div class="flex flex-column gap-3">
  <div class="flex flex-row justify-content-between align-items-end">
    <div class="flex flex-column">
      <h1 class="page-h1">Password Rush Rules</h1>
      <div
        class="flex flex-row text-yellow-500 text-sm justify-content-start gap-2"
      >
        <i class="pi pi-exclamation-triangle"></i>
        <span>Minimum rules for Password Rush are 9</span>
      </div>
      <div class="text-xs text-color-secondary mt-2">
        These rules is not editable.
      </div>
    </div>
    <!-- <button pButton icon="pi pi-plus" (click)="toggleCreateRuleDialogVisibility()">Create Rule</button> -->
  </div>
  <div class="surface-100 border-round flex flex-column gap-2 p-4" *ngIf="!isLoading, else loading">
    @if (rules.length <= 0) { No rules yet. } @else {
      <p-accordion value="0">
        @for (rule of rules; track rule.id; let i = $index) {
          <p-accordion-panel [value]="i">
            <p-accordion-header>
              @if (includeFormat(rule.description)) {
                {{ formatString(rule.description) }}
              } @else {
                {{ rule.description }}
              }
            </p-accordion-header>
            <p-accordion-content>
              <div class="flex flex-column gap-2">
                @if (rule.is_required) {
                  <div class="font-light text-sm text-green-600">
                    This rule is required to include in Password Rush
                  </div>
                }
                @if (rule.addon === "random_num") {
                  <div class="text-green-800">
                    Random number in range: {{ rule.range?.min ?? 0 }}(min) - {{ rule.range?.max ?? 100 }}(max)
                  </div>
                } @else if (rule.addon === "word") {
                  <div class="text-green-800">
                    Random {{ rule.range?.word_number ?? 1 }} word(s): {{ rule.range?.words?.toString() }}
                  </div>
                }
              </div>
            </p-accordion-content>
          </p-accordion-panel>
        }
      </p-accordion>
    }
  </div>
  <ng-template #loading>
    <p-skeleton width="100%" height="4rem" />
  </ng-template>
</div>

<!-- <p-dialog header="Create New Rule" [modal]="true" [(visible)]="visible" [style]="{ width: '50%' }" (onHide)="resetCreateRuleForm()">
  <form [formGroup]="createRuleForm" (ngSubmit)="onCreateRule()">
    <div class="flex flex-column align-items-start gap-1 mb-4">
      <label for="description" class="font-semibold">Description</label>
      <input pInputText id="description" formControlName="description" class="w-full" />
      @if (isFieldInvalid('description')) {
        <span class="text-red-500 text-xs" *ngIf="createRuleForm.get('description')?.errors?.['required']">Description is required</span>
      } 
    </div>
    <div class="flex flex-column align-items-start gap-1 mb-4">
      <label for="words" class="font-semibold">Required Word(s)</label>
      <span class="p-text-secondary text-xs font-light">Separate the words with comma. (e.g., password, secure, strong)</span>
      <input pInputText id="words" formControlName="words" class="w-full" />
      @if (isFieldInvalid('words')) {
        <span class="text-red-500 text-xs" *ngIf="createRuleForm.get('words')?.errors?.['required']">This field is required</span>
      } 
    </div>
    <div class="flex justify-content-end gap-2">
        <p-button label="Cancel" severity="secondary" (click)="toggleCreateRuleDialogVisibility()" />
        <p-button label="Create" type="submit" />
    </div>
  </form>
</p-dialog> -->

<p-toast></p-toast>
